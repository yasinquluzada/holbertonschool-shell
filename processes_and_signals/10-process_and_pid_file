#!/usr/bin/env bash
# Creates a PID file, prints a message forever and handles signals.

PID_FILE="/var/run/myscript.pid"

# Write this script's PID into the PID file
echo "$$" > "$PID_FILE"

# SIGINT (Ctrl+C): just complain, do NOT remove the PID file or exit
handle_sigint() {
    echo "Y U no love me?!"
}

# SIGTERM: complain, remove the PID file, then exit
handle_sigterm() {
    echo "I hate the kill command"
    rm -f "$PID_FILE"
    exit 0
}

# SIGQUIT: just remove the PID file, then exit
handle_sigquit() {
    rm -f "$PID_FILE"
    exit 0
}

trap 'handle_sigint' INT
trap 'handle_sigterm' TERM
trap 'handle_sigquit' QUIT

# Infinite loop
while true; do
    echo "To infinity and beyond"
    sleep 2
done
